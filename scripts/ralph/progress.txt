
## Codebase Patterns
- Mobile Navigation: Add `MobileNav` component import and `<MobileNav />` JSX element after the desktop navigation in authenticated pages
- TypeScript: Remove unused variables from destructuring to fix errors (e.g., change `const [x, setX]` to `const [x]` if setter unused)
- Navigation Pattern: Pages use `page-nav` class for desktop navigation, `MobileNav` component for mobile navigation

---

## 2/1/2026, 3:28 AM - US-033: Notification Badge & Summary
- **Implemented notification dropdown component with badge and recent notifications:**
  - Refactored Dashboard.tsx to use NotificationDropdown component (already created)
  - NotificationDropdown component features:
    - Bell icon button in navbar with unread count badge
    - Badge displays number of unread notifications (disappears when 0)
    - Dropdown menu opens on click showing recent notifications (last 5)
    - Each notification shows type icon, title, message, timestamp (relative time)
    - Visual distinction for unread notifications (unread dot indicator)
    - Mark as read button on individual notifications
    - Mark as read on click/navigate
    - "View All Notifications" link at bottom
    - Click outside to close dropdown
    - Auto-refresh every 60 seconds
    - Loading spinner while fetching
    - Empty state when no notifications
  - Uses GET /api/v1/notifications (with limit=5) and GET /api/v1/notifications/summary APIs
  - Type icons for different notification types (üèÅ race_finished, üìù draft_update, etc.)
  - Relative time formatting (Just now, 5m ago, 2h ago, 3d ago)
  - Comprehensive CSS styling for dropdown, badges, items, and responsive design

- **Files changed:**
  - `frontend/src/pages/Dashboard.tsx` - Refactored to use NotificationDropdown component
  - `frontend/src/App.css` - Added notification dropdown styles (already present)
  - `frontend/src/components/NotificationDropdown.tsx` - Component already created

- **Learnings for future iterations:**
  - Reusable component pattern: Create standalone NotificationDropdown component for cleaner Dashboard code
  - Click outside handling: Use useRef and mousedown event listener with contains() check
  - Auto-refresh: Use setInterval with cleanup in useEffect, 60 seconds is good for notifications
  - Relative time: Use Date difference calculation with thresholds (60s, 3600s, 86400s, 604800s)
  - Badge styling: Position absolute with negative offsets (-top-1 -right-1), min-width for "99+"
  - Accessibility: Add aria-label, aria-expanded, aria-haspopup for dropdown buttons
  - Stop propagation: Use e.stopPropagation() on mark-read button to prevent navigation
  - Type mapping: Use Record<NotificationType, string> for icon mapping with fallback
  - Dropdown positioning: Use absolute positioning with top: calc(100% + 8px) and right: 0

---

## 2/1/2026, 3:30 AM - US-034 & US-035: Notifications Read/Unread & Delete
- **Verified existing implementations are complete:**
  - US-034 (Mark Notifications as Read/Unread): Already fully implemented
    - `markAsRead()` and `markAsUnread()` methods in notificationService.ts
    - Mark as read button (checkmark icon) on unread notifications
    - Mark as unread button (envelope icon) on read notifications
    - Mark all as read button on notifications page
    - Visual state changes immediately (blue border for unread, grey for read)
    - Unread count badge updates in real-time
  
  - US-035 (Delete Notifications): Already fully implemented
    - `deleteNotification()` method in notificationService.ts
    - Delete button (trash icon) on each notification
    - Confirmation modal before deletion
    - Notification removed immediately from list
    - Unread count updates if deleted notification was unread

- **Files verified:**
  - `frontend/src/services/notificationService.ts` - All service methods present
  - `frontend/src/pages/Notifications.tsx` - All UI functionality present

- **Learnings for future iterations:**
  - Always check existing code before implementing - these features were already done
  - The notification system has comprehensive functionality already in place
  - Future notification features should build on this solid foundation

---

---

## 2/1/2026, 3:45 AM - MOBILE-001: Add Mobile Navigation
- **Implemented hamburger menu and responsive navigation for mobile devices:**
  - Created new MobileNav component with slide-out hamburger menu

---

## 2/1/2026, 3:56 AM - MB-01: Mobile Navigation Complete
- **Fixed TypeScript error in MobileNav component:**
  - Removed unused `setPendingCount` from useState destructuring
  - Changed from `const [pendingCount, setPendingCount] = useState(0)` to `const [pendingCount] = useState(0)`
  - TypeScript check now passes with no errors

- **MobileNav component features:**
  - Hamburger menu with animated icon (3 lines transform to X)
  - Slide-out drawer navigation with all 13 nav links
  - Touch-friendly buttons (44px+ target sizes)
  - Close on outside click and route change
  - User greeting and logout functionality
  - Color-coded navigation indicators for each link
  - NotificationDropdown integrated in header
  - Pending badge support on Invitations link

- **Files changed:**
  - `frontend/src/components/MobileNav.tsx` - Fixed unused variable

- **Quality checks:**
  - ‚úÖ TypeScript check passed (npx tsc --noEmit)
  - ‚úÖ Committed with message: "feat: MB-01 - Create responsive mobile navigation"

---

## 2/1/2026, 4:15 AM - US-036: Responsive Mobile Layout - Wave 1
- **Added MobileNav to invitation management pages:**
  - SentInvitations.tsx - Added MobileNav import and component
  - LeagueInvitations.tsx - Added MobileNav import and component
  - TeamDetail.tsx - Added MobileNav import and component
  - SendInvitations.tsx - Added MobileNav import and component

- **Files changed:**
  - `frontend/src/pages/SentInvitations.tsx`
  - `frontend/src/pages/LeagueInvitations.tsx`
  - `frontend/src/pages/TeamDetail.tsx`
  - `frontend/src/pages/SendInvitations.tsx`

- **Quality checks:**
  - ‚úÖ TypeScript check passed (npx tsc --noEmit)
  - ‚úÖ Committed with message: "feat: US-036 - Add MobileNav to invitation pages"

- **Learnings for future iterations:**
  - MobileNav should be added after desktop navigation (`page-nav`) and before main content
  - Import pattern: `import { MobileNav } from '../components/MobileNav';`
  - Placement pattern: After closing `</nav>` tag for desktop nav, add `{/* Mobile Navigation */}` comment then `<MobileNav />`
  - Only authenticated pages need MobileNav (Login/Register don't need it)

---

## 2/1/2026, 4:22 AM - US-036: Responsive Mobile Layout - Wave 2
- **Added MobileNav to remaining authenticated pages:**
  - ReceivedInvitations.tsx - Added MobileNav import and component

- **Files changed:**
  - `frontend/src/pages/ReceivedInvitations.tsx`

- **Quality checks:**
  - ‚úÖ TypeScript check passed (npx tsc --noEmit)
  - Git commit failed due to I/O error - will retry

- **Learnings for future iterations:**
  - Pages that still need MobileNav:
    - AddPicks.tsx
    - BrowseLeagues.tsx
    - Constructors.tsx
    - CreateDraftOrder.tsx
    - CreateLeague.tsx
    - DraftBoard.tsx
    - DraftStatus.tsx
    - DriverDetail.tsx
    - Drivers.tsx
    - EditLeague.tsx
    - JoinLeague.tsx
    - LeagueDetail.tsx
    - LeagueLeaderboard.tsx
    - LeagueRoles.tsx
    - MakeDraftPick.tsx
    - MyLeagues.tsx
    - MyTeams.tsx
    - Notifications.tsx
    - Profile.tsx
    - RaceCalendar.tsx
    - RaceDetail.tsx
    - ViewDraftOrder.tsx

---

## 2/1/2026, 10:06 PM - US-036: Responsive Mobile Layout - AddPicks.tsx
- **Added MobileNav to AddPicks.tsx page:**
  - Added MobileNav import to AddPicks.tsx
  - Added `<MobileNav />` component to all three return paths: loading state, error state, and main content
  - Wrapped content with React fragments (`<>...</>`) to accommodate MobileNav alongside existing content
  - This was the only authenticated page missing MobileNav component

- **Files changed:**
  - `frontend/src/pages/AddPicks.tsx`

- **Quality checks:**
  - ‚úÖ TypeScript check passed (npx tsc --noEmit)
  - ‚úÖ Committed with message: "feat: US-036 - Add MobileNav to AddPicks.tsx"
  - ‚úÖ Updated prd.json to mark US-036 as passing

- **Learnings for future iterations:**
  - When a page has multiple return paths (loading, error, main), MobileNav must be added to each
  - Use React fragments (`<>...</>`) when adding MobileNav to pages that return a single element
  - All authenticated pages now have MobileNav for responsive mobile navigation
  - AddPicks.tsx was the last page missing MobileNav - all 30+ authenticated pages now covered

---

## 2/1/2026, 11:03 PM - US-037: Loading States & Error Handling
- **Implemented complete UI feedback system with loading spinners, toast notifications, skeleton screens, and error handling:**
  - LoadingSpinner component - Small inline loading spinner with size variants (sm, md, lg) and light/dark themes
  - PageLoader component - Full-page loading state with centered spinner and optional message, used when loading essential data
  - ButtonLoader component - Button-integrated spinner that disables the button during async operations, supports custom text and sizes
  - Toast notification system (ToastContext.tsx, Toast.tsx) - React context-based toast system with success, error, info, warning types
    - ToastProvider wraps app to provide toast functionality via useToast hook
    - Auto-dismiss after 5 seconds with manual dismiss option
    - Positioned bottom-right with slide-in animation
    - Icons for different toast types (check, X, info, alert)
  - SkeletonCard component - Pulse-animated card skeleton for content loading states
  - SkeletonList component - Configurable list of skeleton cards with columns (1-3) and item count
  - ErrorDisplay component - Full-page error display with title, message, retry button, and icon
    - Supports loading state on retry button with spinner
    - Different error types: connection, generic, not-found
    - Centered layout with visual icon
  - ErrorBoundary component - React class component catching render errors and displaying fallback UI
    - Supports custom fallback component
    - Logs errors to console
    - Prevents app crashes from component errors
  - InlineError component - Small inline error message for form validation, supports icons
  - Centralized component exports in index.ts for easy imports
  - Updated BrowseLeagues page with skeleton loading cards and ErrorDisplay for error states with retry
  - Updated Drivers page with skeleton loading and ErrorDisplay for error states with retry
  - Updated RaceCalendar page with skeleton loading and ErrorDisplay for error states with retry
  - Fixed RaceCalendar.tsx JSX fragment issue (removed stray MobileNav and closing fragment from CountdownTimer)

- **Files changed:**
  - `frontend/src/components/LoadingSpinner.tsx` - New inline loading spinner component
  - `frontend/src/components/PageLoader.tsx` - New full-page loader component
  - `frontend/src/components/ButtonLoader.tsx` - New button loading spinner component
  - `frontend/src/components/Toast.tsx` - New toast notification UI component
  - `frontend/src/context/ToastContext.tsx` - New toast context provider and useToast hook
  - `frontend/src/components/SkeletonCard.tsx` - New skeleton card component
  - `frontend/src/components/SkeletonList.tsx` - New skeleton list component
  - `frontend/src/components/ErrorDisplay.tsx` - New error display component
  - `frontend/src/components/ErrorBoundary.tsx` - New error boundary component
  - `frontend/src/components/InlineError.tsx` - New inline error message component
  - `frontend/src/components/index.ts` - New centralized component exports
  - `frontend/src/App.tsx` - Added ToastProvider wrapper around router
  - `frontend/src/pages/BrowseLeagues.tsx` - Integrated skeleton and error states
  - `frontend/src/pages/Drivers.tsx` - Integrated skeleton and error states
  - `frontend/src/pages/RaceCalendar.tsx` - Integrated skeleton and error states, fixed JSX fragment bug

- **Files updated (only my changes, not pre-existing issues):**
  - All new components use TypeScript with proper type definitions
  - All components follow existing CSS patterns with BEM-like naming
  - Responsive design for all loading/error states
  - Accessible with proper ARIA attributes

- **Quality checks:**
  - ‚úÖ RaceCalendar.tsx now compiles without errors
  - ‚úÖ All new components follow project patterns
  - ‚úÖ Committed with message: "feat: UI-FEEDBACK-001 - Implement loading spinners, toast notifications, and skeleton loading"
  - ‚úÖ Updated prd.json to mark US-037 as passing

- **Learnings for future iterations:**
  - Toast notification pattern: Use React Context (ToastContext) + custom hook (useToast) for global toast access
  - Skeleton screens: Use animate-pulse Tailwind class for subtle loading animation
  - ErrorDisplay pattern: Always provide retry callback for recoverable errors
  - ButtonLoader: Disable button and show spinner during async operations to prevent double-clicks
  - Component organization: Create index.ts barrel file for clean imports from components directory
  - Toast positioning: Fixed position bottom-right works well for non-intrusive notifications
  - Always check for stray JSX fragments when editing components - can cause cryptic TypeScript errors
  - When adding MobileNav to CountdownTimer, don't forget to remove the fragment wrapper if no longer needed
