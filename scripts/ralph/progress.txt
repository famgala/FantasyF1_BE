## Codebase Patterns
- Use `sql<number>` template for aggregations
- Always use `IF NOT EXISTS` for migrations
- Export types from actions.ts for UI components
- For Python 3.10 compatibility: Use `datetime.now(timezone.utc)` instead of `datetime.now(UTC)` - UTC constant is only available in Python 3.11+
- When adding budget tracking: Add total_budget field to FantasyTeam model, create migration, implement calculate_budget_spent() method, update add_driver_pick() with validation, update remove_pick() with refund
- For polling-based real-time updates: Use `useRef<ReturnType<typeof setInterval> | null>(null)` for timer references (not `NodeJS.Timeout` which requires @types/node)
- When implementing real-time updates: Create a reusable ConnectionStatus component with visual indicators (connecting/connected/error), last updated timestamp, and manual refresh button
- For "Your Turn" notifications: Track previous current team ID with a ref to detect when it becomes the user's turn, show toast notification only once per turn change
- For role-based UI features: Create GET /api/v1/leagues/{league_id}/my-role endpoint, use role badges with gradient backgrounds and icons (gold/crown for Creator, blue/star for Co-Manager, gray/user for Member), add hover tooltips for permissions explanation

## [2026-02-02 8:13 PM] - US-052
- Implemented complete budget tracking system for fantasy teams
- Files changed:
  - FantasyF1_BE/app/models/fantasy_team.py (added total_budget field, calculate_budget_spent method)
  - FantasyF1_BE/alembic/versions/003_add_total_budget.py (new migration)
  - FantasyF1_BE/app/services/fantasy_team_service.py (updated add_driver_pick with budget validation, updated remove_pick with refund)
  - FantasyF1_BE/app/schemas/team.py (updated TeamResponse with total_budget, budget_spent, budget_remaining)
  - frontend/src/pages/TeamDetail.tsx (added budget display with progress bar)
  - frontend/src/services/teamService.ts (updated getTeamDetail to include budget fields)
  - frontend/src/types/index.ts (updated TeamDetail type with budget fields)
  - FantasyF1_BE/app/services/draft_service.py (fixed UTC import for Python 3.10)
  - FantasyF1_BE/app/services/notification_service.py (fixed UTC import for Python 3.10)
  - FantasyF1_BE/tests/test_notification_endpoints.py (fixed UTC import for Python 3.10)
- **Learnings for future iterations:**
  - Python 3.10 compatibility: The `UTC` constant from `datetime` module is only available in Python 3.11+. For Python 3.10, use `timezone.utc` instead.
  - Budget tracking requires: model field, migration, calculation method, validation in add operations, refund in remove operations, and schema updates.
  - When adding new fields to models, always create a migration file in alembic/versions/.
  - The progress bar visual indicator uses percentage-based width with color coding (green > 50%, yellow 20-50%, red < 20%).

## [2026-02-03 8:26 PM] - US-055
- Implemented polling-based real-time draft updates
- Files changed:
  - frontend/src/components/ConnectionStatus.tsx (new component for connection status display)
  - frontend/src/components/index.ts (exported ConnectionStatus component and ConnectionStatusType)
  - frontend/src/pages/DraftBoard.tsx (added polling every 3 seconds, connection status tracking, auto-refresh)
  - frontend/src/pages/MakeDraftPick.tsx (added polling, connection status, "Your Turn!" toast notification)
- **Learnings for future iterations:**
  - For polling-based real-time updates: Use `useRef<ReturnType<typeof setInterval> | null>(null)` for timer references (not `NodeJS.Timeout` which requires @types/node).
  - When implementing real-time updates: Create a reusable ConnectionStatus component with visual indicators (connecting/connected/error), last updated timestamp, and manual refresh button.
  - For "Your Turn" notifications: Track previous current team ID with a ref to detect when it becomes the user's turn, show toast notification only once per turn change.
  - Polling interval of 3 seconds provides good balance between real-time updates and API load.
  - Connection status should be set to 'error' on polling failures but not on initial load failures (to avoid showing error on first load).
  - Use refs to track state that shouldn't trigger re-renders (like previous team ID, notification flags).

## [2026-02-03 8:38 PM] - US-056
- Implemented complete My Role display in LeagueDetail.tsx
- Files changed:
  - FantasyF1_BE/app/api/v1/leagues.py (added GET /api/v1/leagues/{league_id}/my-role endpoint)
  - FantasyF1_BE/app/schemas/league.py (added MyRoleResponse schema)
  - FantasyF1_BE/app/services/league_service.py (added get_my_role service method)
  - frontend/src/services/leagueService.ts (added getMyRole method)
  - frontend/src/types/index.ts (added MyRoleResponse type)
  - frontend/src/pages/LeagueDetail.tsx (added prominent role badge in header with gold/blue/gray gradients and icons, hover tooltip for permissions explanation)
  - frontend/src/App.css (added comprehensive CSS styling for role-badge classes with gradients, shadows, hover effects, and responsive breakpoints)
- **Learnings for future iterations:**
  - For role-based UI features: Create GET /api/v1/leagues/{league_id}/my-role endpoint, use role badges with gradient backgrounds and icons (gold/crown for Creator, blue/star for Co-Manager, gray/user for Member), add hover tooltips for permissions explanation.
  - Role badges should be prominent in the UI header to help users understand their permissions at a glance.
  - Use CSS gradients for visual distinction between roles: gold gradient (linear-gradient(135deg, #ffd700 0%, #ffec8b 100%)) for Creator, blue gradient (linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%)) for Co-Manager, gray gradient (linear-gradient(135deg, #6b7280 0%, #9ca3af 100%)) for Member.
  - Add hover tooltips with role permissions explanation to help users understand what they can do in the league.
  - Responsive design: On mobile, role badge should be smaller and positioned appropriately in the header.
  - Typecheck passes for both backend and frontend code.

## [2026-02-03 8:47 PM] - US-057
- Implemented complete Help & Documentation Center at /help
- Files changed:
  - frontend/src/pages/Help.tsx (new page component with searchable help articles, FAQ section, contact form, keyboard shortcuts)
  - frontend/src/pages/Dashboard.tsx (added Help button to navigation)
  - frontend/src/App.tsx (added /help route)
  - frontend/src/components/MobileNav.tsx (added Help button to mobile navigation)
  - scripts/ralph/prd.json (updated US-057 to passes: true)
- **Learnings for future iterations:**
  - Help Center content can be stored as static data arrays (helpArticles, faqs, keyboardShortcuts) within the component for simplicity.
  - Use HTML content in help articles for rich formatting (headings, lists, bold text) with dangerouslySetInnerHTML.
  - Category filtering: Create a categories array and filter both articles and FAQs by selected category.
  - Search functionality: Filter by title, content, and tags for articles; by question and answer for FAQs.
  - FAQ accordion: Use index-based state (expandedFAQ: number | null) to track which FAQ is expanded.
  - Contact form: Include form validation, success message display, and auto-reset after submission.
  - Keyboard shortcuts: Display in a grid with key badges using <kbd> element for visual styling.
  - Responsive design: Use grid layouts (md:grid-cols-2, lg:grid-cols-3) for cards, flex-wrap for category buttons.
  - Typecheck passes - ensure all imports use type-only imports for types when verbatimModuleSyntax is enabled.
  - When adding navigation buttons, remember to add them to both Dashboard.tsx (desktop) and MobileNav.tsx (mobile) for consistent UX.